# xhtml mp浅析

很早以前就想了解一下wml和wcss，借助春节假期的间隙，阅读了nokia xhtml指南和相关文献，感慨良多，这真是一次迟来的阅读。
网上的各种重复资料太多了，写一点自己的感想和总结：

## 一、基础概念

wap的发展基本上也是经过了一个从私有到规范的过程，目前的wap2.0应该说是从协议到描述语言，逐渐在向有线互联网靠拢，它终端的基本构成是xhtml mp和wcss，二者的关系就像html之于css；

xhtml mp基于xhtml basic的定义并扩展（包括支持wcss）、wcss则是css2的子集并进行私有扩展；
最大的优势是向规范靠拢，这样wap站点任何支持规范的终端都可以正常访问并应用。

## 二、xhtml mp

既然靠拢了规范，它势必摒弃了一些”不规范”的旧有特性，如：

* deck、card、do、anchor、timer、等其他xhtml不允许的标签和应用逻辑
* 不支持非标准事件、变量、客户端脚本、锚点数据
* 必须要有xml声明，这一点不是很确定，从web得来的经验告诉我们：教条不可信，需要更多的测试和阅读。

总之，可以说xhtml mp是完全遵照w3对web的成熟定义，熟悉web开发的人可以很快上手，几乎不需要什么过渡过程，可能在不同终端的处理上尚需经验，但的确是门槛甚低。

## 三、wcss

除了语法相同，它提供了可和web媲美的大多数属性（包括float和支持有限的position），并且提供不少相当有用的私有属性，这些属性和值以”-wap-”为前缀，例如：

* -wap-accesskey：3（*、#、0-9），它使用规范的方式代替了之前的<do>
* -wap-input-format 它可以定义输入格式
* -wap-marquee 它可以按照相应的规则卷动元素

看起来这些属性并不和表现相关，仿佛违背了分离的思想，不过讽刺的是：css提供的这些属性，实际上是相当实用，而我们却只能通过className去模块化地使用它们。

## 四、兼容性

wap平台的浏览器对比pc更加杂乱，除了几大厂商五花八门的浏览器，还得考虑诸如MTK等山寨os的私有浏览器；
对前端而言最直接的影响就是：

* font-family、font-style等字体属性显得无用，因为不少终端只有1-2种字体并且兼容性不好
* 各种布局属性（包括基本的width、height）的支持千差万别
* js的支持比例一半一半
* 一切全靠测试、折腾…

复杂的终端导致我们只能从GUI设计阶段着手简化，用尽量简洁的设计生成尽量简洁的页面，以尽量小的容量提供给尽量小带宽的下载用户，这就引出此文的第五部分：

## 五：设计优化、可访问性、可用性

这套流程看起来很熟悉：

1. 压缩xhtml、css，缩短各类明明，减小页面大小，这主要是因为终端的缓存限制，以MTK为例（我的山寨机就是），似乎超过20KB的页面就会导致报”下载页面过大”之类的错误，根本无法浏览；
2. 图片压缩，尽可能采用jpg、gif、png-8，尺寸也不宜过大，在小屏幕终端上进行横向卷动是非常困难的事情；
3. 屏幕尺寸以及导航的设计需要考量，尽量减少装饰性图片或背景；
4. 灵活可变的布局，减少卷动
5. 导航清晰、减少主要功能死角

总之，一切为了accessibility和usability

__值得深思的是：nokia文档中有许多关于用户习惯、可用性、可访问性的描述，甚至包括许多类似”根据可用性研究，用户不太热衷于那些由于图像传输而中断 他们任务流的服务”的细节，而此文档的初稿时间是2002年7月，译文时间是2004年5月，04年同期事件是：国内web标准化的呼声刚刚崭露头角，而 当时国内的UCD研究亦处于起步阶段…__

## 六、其他

### 关于css的放置

有不少资料建议将css放置在页面中，不要使用外部链接，理由是link会产生额外的请求，而且全站的css如果都在这一个文件中的话，文件会比较大，影响速度；
不过我觉得，如果每个页面都带有css，如果用户浏览了2、3页，那和使用link没什么区别，而且浏览得越多，下载的多余样式越多，而link一般会进入缓存；
再者，wap站点和web站点不同，它没有类似门面主页的存在，除非特别需要首页打开速度（比如资讯类等不需要登录的站点），选择将link放入页面相对较小的首页反倒是个不错的选择。

### xhtml mp的未来及展望

xhtml诞生以来的最大意义就在于它提出的一种标准、一种强制规范，几乎不会有什么终端、设备会尝试以xml的方式读取xhtml，它的xml特性几乎 从未被我们所用到，html5的出现更是令xhtml非常尴尬，那未来的移动设备会采用什么方式呢？我觉得随着终端机能的增强和带宽的提高，除了xml源 及阅读器，仍然会是提供富交互的html和脚本，互联网跨平台的日子不远了……
